import{p as ue,ax as se,ay as ye,q as ie,E as de,az as ce,aA as be,c as I,J as me,aB as ve,aC as _,L as l,M as H,aD as xe,aE as he,G as g,s as ke,d as we,o as Ce,w as z,b as Pe,aF as Fe,aG as Se,O as j,aa as ae,aH as Ae,aI as Re,aJ as $e,aK as Ie,Q,aL as Me,a as Be,a0 as De,ad as Ue,S as Te,aM as qe,U as Ne,Y as le,W as ze,X as u,aw as Ee,ai as F,af as L,ag as $,ah as He,au as W,V as Ge,$ as Oe,aj as Le,Z as i,aN as je,at as _e,aq as Je,as as Ke,aO as Qe,aP as We,am as Xe,ac as Ye}from"./index-BIBGvyo-.js";import{c as Ze,a as X,b as et,d as tt,u as at,e as E,V as lt}from"./index.esm-DqGq5ZEl.js";import{a as ot,V as oe,b as re}from"./route-block-DgUPUQzj.js";import{V as rt}from"./VDivider-CYuNExOv.js";import{m as nt,a as ne,V as ut,b as st}from"./VDataTable-DuD1S2aJ.js";import{V as it}from"./VToolbar-Bne_zWTX.js";import{V as dt}from"./VContainer-ngeU3hwA.js";import"./VPagination-ugmY0jF9.js";import"./VList-BCHDLTmA.js";import"./VMenu-CW0x7ctf.js";const ct=ue({...se(),...ye(nt(),["inline"])},"VCheckbox"),mt=ie()({name:"VCheckbox",inheritAttrs:!1,props:ct(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,S){let{attrs:f,slots:n}=S;const s=de(e,"modelValue"),{isFocused:d,focus:V,blur:p}=ce(e),M=be(),B=I(()=>e.id||`checkbox-${M}`);return me(()=>{const[c,D]=ve(f),A=_.filterProps(e),y=ne.filterProps(e);return l(_,H({class:["v-checkbox",e.class]},c,A,{modelValue:s.value,"onUpdate:modelValue":x=>s.value=x,id:B.value,focused:d.value,style:e.style}),{...n,default:x=>{let{id:h,messagesId:U,isDisabled:R,isReadonly:k,isValid:w}=x;return l(ne,H(y,{id:h.value,"aria-describedby":U.value,disabled:R.value,readonly:k.value},D,{error:w.value===!1,modelValue:s.value,"onUpdate:modelValue":C=>s.value=C,onFocus:V,onBlur:p}),n)}})}),{}}}),vt=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...se(),...xe()},"VTextarea"),ft=ie()({name:"VTextarea",directives:{Intersect:he},inheritAttrs:!1,props:vt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,S){let{attrs:f,emit:n,slots:s}=S;const d=de(e,"modelValue"),{isFocused:V,focus:p,blur:M}=ce(e),B=I(()=>typeof e.counterValue=="function"?e.counterValue(d.value):(d.value||"").toString().length),c=I(()=>{if(f.maxlength)return f.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function D(t,a){var m,b;!e.autofocus||!t||(b=(m=a[0].target)==null?void 0:m.focus)==null||b.call(m)}const A=g(),y=g(),x=ke(""),h=g(),U=I(()=>e.persistentPlaceholder||V.value||e.active);function R(){var t;h.value!==document.activeElement&&((t=h.value)==null||t.focus()),V.value||p()}function k(t){R(),n("click:control",t)}function w(t){n("mousedown:control",t)}function C(t){t.stopPropagation(),R(),Q(()=>{d.value="",Me(e["onClick:clear"],t)})}function T(t){var m;const a=t.target;if(d.value=a.value,(m=e.modelModifiers)!=null&&m.trim){const b=[a.selectionStart,a.selectionEnd];Q(()=>{a.selectionStart=b[0],a.selectionEnd=b[1]})}}const v=g(),q=g(+e.rows),N=I(()=>["plain","underlined"].includes(e.variant));we(()=>{e.autoGrow||(q.value=+e.rows)});function o(){e.autoGrow&&Q(()=>{if(!v.value||!y.value)return;const t=getComputedStyle(v.value),a=getComputedStyle(y.value.$el),m=parseFloat(t.getPropertyValue("--v-field-padding-top"))+parseFloat(t.getPropertyValue("--v-input-padding-top"))+parseFloat(t.getPropertyValue("--v-field-padding-bottom")),b=v.value.scrollHeight,G=parseFloat(t.lineHeight),J=Math.max(parseFloat(e.rows)*G+m,parseFloat(a.getPropertyValue("--v-input-control-height"))),K=parseFloat(e.maxRows)*G+m||1/0,P=De(b??0,J,K);q.value=Math.floor((P-m)/G),x.value=Be(P)})}Ce(o),z(d,o),z(()=>e.rows,o),z(()=>e.maxRows,o),z(()=>e.density,o);let r;return z(v,t=>{t?(r=new ResizeObserver(o),r.observe(v.value)):r==null||r.disconnect()}),Pe(()=>{r==null||r.disconnect()}),me(()=>{const t=!!(s.counter||e.counter||e.counterValue),a=!!(t||s.details),[m,b]=ve(f),{modelValue:G,...J}=_.filterProps(e),K=Fe(e);return l(_,H({ref:A,modelValue:d.value,"onUpdate:modelValue":P=>d.value=P,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":N.value},e.class],style:e.style},m,J,{centerAffix:q.value===1&&!N.value,focused:V.value}),{...s,default:P=>{let{id:O,isDisabled:Y,isDirty:Z,isReadonly:fe,isValid:pe}=P;return l(Se,H({ref:y,style:{"--v-textarea-control-height":x.value},onClick:k,onMousedown:w,"onClick:clear":C,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},K,{id:O.value,active:U.value||Z.value,centerAffix:q.value===1&&!N.value,dirty:Z.value||e.dirty,disabled:Y.value,focused:V.value,error:pe.value===!1}),{...s,default:ge=>{let{props:{class:ee,...te}}=ge;return l(j,null,[e.prefix&&l("span",{class:"v-text-field__prefix"},[e.prefix]),ae(l("textarea",H({ref:h,class:ee,value:d.value,onInput:T,autofocus:e.autofocus,readonly:fe.value,disabled:Y.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:R,onBlur:M},te,b),null),[[Ae("intersect"),{handler:D},null,{once:!0}]]),e.autoGrow&&ae(l("textarea",{class:[ee,"v-textarea__sizer"],id:`${te.id}-sizer`,"onUpdate:modelValue":Ve=>d.value=Ve,ref:v,readonly:!0,"aria-hidden":"true"},null),[[Re,d.value]]),e.suffix&&l("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:a?P=>{var O;return l(j,null,[(O=s.details)==null?void 0:O.call(s,P),t&&l(j,null,[l("span",null,null),l($e,{active:e.persistentCounter||V.value,value:B.value,max:c.value,disabled:e.disabled},s.counter)])])}:void 0})}),Ie({},A,y,h)}}),pt={class:"text-center"},gt={__name:"products",setup(e){const{apiAuth:S}=Xe(),f=Ue(),{t:n}=Te(),s=qe([]),d=g(""),V=I(()=>[{title:"ID",key:"_id",sortable:!0},{title:n("product.image"),key:"image",sortable:!1},{title:n("product.name"),key:"name",sortable:!0},{title:n("product.description"),key:"description",sortable:!0},{title:n("product.price"),key:"price",sortable:!0},{title:n("product.category"),key:"category",sortable:!0},{title:n("product.sell"),key:"sell",sortable:!0},{title:n("product.createdAt"),key:"createdAt",sortable:!0},{title:n("product.updatedAt"),key:"updatedAt",sortable:!0},{title:n("adminProduct.edit"),key:"edit",sortable:!1}]),p=g([]),M=g([]),B=g(null),c=g({open:!1,id:""}),D=o=>{o&&(c.value.id=o._id,k.value.value=o.name,w.value.value=o.price,C.value.value=o.description,T.value.value=o.category,v.value.value=o.sell),c.value.open=!0},A=()=>{R(),c.value.id="",c.value.open=!1,B.value.deleteFileRecord()},y=async()=>{var o,r;try{const{data:t}=await S.get("/product/all");s.push(...t.result)}catch(t){console.log(t),f({text:n("api."+((r=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:r.message)||"unknownError"),snackbarProps:{color:"red"}})}};y();const x=Ze({name:X().required(n("api.productNameRequired")),price:et().typeError(n("api.productPriceRequired")).required(n("api.productPriceRequired")).min(0,n("api.productPriceTooSmall")),description:X().required(n("api.productDescriptionRequired")),category:X().required(n("api.productCategoryRequired")).oneOf(["food","drink","music","phone"],n("api.productCategoryInvalid")),sell:tt().required(n("api.productSellRequired"))}),{handleSubmit:h,isSubmitting:U,resetForm:R}=at({validationSchema:x,initialValues:{name:"",price:0,description:"",category:"",sell:!1}}),k=E("name"),w=E("price"),C=E("description"),T=E("category"),v=E("sell"),q=I(()=>[{text:n("productCategory.food"),value:"food"},{text:n("productCategory.drink"),value:"drink"},{text:n("productCategory.music"),value:"music"},{text:n("productCategory.phone"),value:"phone"}]),N=h(async o=>{var r;if(!((r=p.value[0])!=null&&r.error)){if(c.value.id.length===0&&p.value.length===0){f({text:n("api.productImageRequired"),snackbarProps:{color:"red"}});return}try{const t=new FormData;t.append("name",o.name),t.append("price",o.price),t.append("description",o.description),t.append("category",o.category),t.append("sell",o.sell),p.value.length>0&&t.append("image",p.value[0].file),c.value.id.length>0?await S.patch("/product/"+c.value.id,t):await S.post("/product",t),s.splice(0,s.length),y(),f({text:n(c.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),A()}catch(t){console.log(t),f({text:n("api.productImageRequired"),snackbarProps:{color:"red"}})}}});return(o,r)=>{const t=Ne("VueFileAgent");return le(),ze(j,null,[l(dt,null,{default:u(()=>[l(ot,null,{default:u(()=>[l(oe,{cols:"12"},{default:u(()=>[Ee("h1",pt,F(o.$t("nav.adminProducts")),1)]),_:1}),l(rt),l(oe,{cols:"12"},{default:u(()=>[l(ut,{items:s,headers:V.value,search:d.value},{top:u(()=>[l(it,null,{default:u(()=>[l(L,{onClick:r[0]||(r[0]=a=>D(null))},{default:u(()=>[$(F(o.$t("adminProduct.new")),1)]),_:1}),l(He),l(W,{modelValue:d.value,"onUpdate:modelValue":r[1]||(r[1]=a=>d.value=a),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.image":u(({value:a})=>[l(Ge,{src:a,height:"50"},null,8,["src"])]),"item.sell":u(({value:a})=>[a?(le(),Oe(Ye,{key:0,icon:"mdi-check"})):Le("",!0)]),"item.createdAt":u(({value:a})=>[$(F(new Date(a).toLocaleString()),1)]),"item.updatedAt":u(({value:a})=>[$(F(new Date(a).toLocaleString()),1)]),"item.category":u(({value:a})=>[$(F(o.$t(`productCategory.${a}`)),1)]),"item.edit":u(({item:a})=>[l(L,{icon:"mdi-pencil",variant:"text",onClick:m=>D(a)},null,8,["onClick"])]),_:2},1032,["items","headers","search"])]),_:1})]),_:1})]),_:1}),l(We,{modelValue:c.value.open,"onUpdate:modelValue":r[9]||(r[9]=a=>c.value.open=a),persistent:"",class:"w-50"},{default:u(()=>[l(lt,{disabled:i(U),onSubmit:je(i(N),["prevent"])},{default:u(()=>[l(_e,null,{default:u(()=>[l(Je,null,{default:u(()=>[$(F(o.$t(c.value.id?"adminProduct.edit":"adminProduct.new")),1)]),_:1}),l(Ke,null,{default:u(()=>[l(W,{modelValue:i(k).value.value,"onUpdate:modelValue":r[2]||(r[2]=a=>i(k).value.value=a),label:o.$t("product.name"),"error-messages":i(k).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(W,{modelValue:i(w).value.value,"onUpdate:modelValue":r[3]||(r[3]=a=>i(w).value.value=a),label:o.$t("product.price"),"error-messages":i(w).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(st,{modelValue:i(T).value.value,"onUpdate:modelValue":r[4]||(r[4]=a=>i(T).value.value=a),"error-messages":i(T).errorMessage.value,label:o.$t("product.category"),items:q.value,"item-title":"text","item-value":"value"},null,8,["modelValue","error-messages","label","items"]),l(mt,{modelValue:i(v).value.value,"onUpdate:modelValue":r[5]||(r[5]=a=>i(v).value.value=a),label:o.$t("product.onSell"),"error-messages":i(v).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(ft,{modelValue:i(C).value.value,"onUpdate:modelValue":r[6]||(r[6]=a=>i(C).value.value=a),label:o.$t("product.description"),"error-messages":i(C).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(t,{ref_key:"fileAgent",ref:B,modelValue:p.value,"onUpdate:modelValue":r[7]||(r[7]=a=>p.value=a),"raw-model-value":M.value,"onUpdate:rawModelValue":r[8]||(r[8]=a=>M.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":o.$t("fileAgent.helpText"),"error-text":{type:o.$t("fileAgent.errorType"),size:o.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),l(Qe,null,{default:u(()=>[l(L,{class:"border",onClick:A},{default:u(()=>[$(F(o.$t("adminProduct.cancel")),1)]),_:1}),l(L,{class:"border",type:"submit",loading:i(U)},{default:u(()=>[$(F(o.$t("adminProduct.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof re=="function"&&re(gt);export{gt as default};
